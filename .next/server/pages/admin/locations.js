(()=>{var e={};e.id=673,e.ids=[673,888,660],e.modules={6638:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{config:()=>m,default:()=>u,getServerSideProps:()=>g,getStaticPaths:()=>p,getStaticProps:()=>x,reportWebVitals:()=>f,routeModule:()=>w,unstable_getServerProps:()=>v,unstable_getServerSideProps:()=>S,unstable_getStaticParams:()=>b,unstable_getStaticPaths:()=>y,unstable_getStaticProps:()=>j});var o=r(7093),a=r(5244),i=r(1323),n=r(2899),c=r.n(n),l=r(6814),d=r(3432),h=e([l,d]);[l,d]=h.then?(await h)():h;let u=(0,i.l)(d,"default"),x=(0,i.l)(d,"getStaticProps"),p=(0,i.l)(d,"getStaticPaths"),g=(0,i.l)(d,"getServerSideProps"),m=(0,i.l)(d,"config"),f=(0,i.l)(d,"reportWebVitals"),j=(0,i.l)(d,"unstable_getStaticProps"),y=(0,i.l)(d,"unstable_getStaticPaths"),b=(0,i.l)(d,"unstable_getStaticParams"),v=(0,i.l)(d,"unstable_getServerProps"),S=(0,i.l)(d,"unstable_getServerSideProps"),w=new o.PagesRouteModule({definition:{kind:a.x.PAGES,page:"/admin/locations",pathname:"/admin/locations",bundlePath:"",filename:""},components:{App:l.default,Document:c()},userland:d});s()}catch(e){s(e)}})},862:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{Z:()=>x});var o=r(997),a=r(2210),i=r(6134),n=r(1664),c=r.n(n),l=r(1649),d=r(6689),h=r(8726),u=e([a,i]);function x({children:e}){let{data:t}=(0,l.useSession)(),{isAdmin:r}=(0,h.A)(),[s,n]=(0,d.useState)("");console.log("Session data:",t),console.log("Is admin:",r);let u=e=>{e.preventDefault(),console.log("Searching for:",s)};return(0,o.jsxs)(a.Box,{children:[o.jsx(a.Box,{as:"nav",bg:"primary.600",py:2,position:"sticky",top:0,zIndex:1e3,children:o.jsx(a.Container,{maxW:"container.xl",children:(0,o.jsxs)(a.Flex,{align:"center",gap:4,children:[o.jsx(a.Link,{as:"a",href:"/",fontSize:"xl",fontWeight:"bold",color:"white",_hover:{textDecoration:"none",color:"primary.100"},children:"EventHub"}),o.jsx(a.Flex,{flex:1,mx:4,children:o.jsx("form",{onSubmit:u,style:{width:"100%"},children:(0,o.jsxs)(a.InputGroup,{size:"md",children:[o.jsx(a.Input,{bg:"white",placeholder:"Search events...",value:s,onChange:e=>n(e.target.value),borderRadius:"md",height:"40px",_focus:{borderColor:"secondary.300",boxShadow:"0 0 0 1px var(--chakra-colors-secondary-300)"}}),o.jsx(a.InputRightElement,{h:"100%",children:o.jsx(a.Button,{height:"100%",w:"100%",onClick:u,bg:"secondary.500",color:"white",_hover:{bg:"secondary.600"},borderLeftRadius:"0",borderRightRadius:"md",children:o.jsx(i.SearchIcon,{})})})]})})}),o.jsx(a.Flex,{gap:4,align:"center",children:t?(0,o.jsxs)(o.Fragment,{children:[o.jsx(a.Link,{as:"a",href:"/events/create",color:"white",_hover:{color:"secondary.200"},children:"Create Event"}),r&&o.jsx(a.Button,{as:"a",href:"/admin",colorScheme:"red",size:"sm",leftIcon:o.jsx(a.Icon,{as:i.StarIcon}),_hover:{bg:"red.600"},children:"Admin"}),(0,o.jsxs)(a.Menu,{children:[o.jsx(a.MenuButton,{as:a.Button,variant:"ghost",color:"white",_hover:{bg:"primary.700"},_active:{bg:"primary.700"},children:"Account"}),(0,o.jsxs)(a.MenuList,{children:[o.jsx(a.MenuItem,{as:"a",href:"/profile",children:"Profile"}),o.jsx(a.MenuItem,{as:"a",href:"/favorites",children:"My Favorites"}),o.jsx(a.MenuItem,{onClick:()=>{(0,l.signOut)({callbackUrl:"/",redirect:!0})},children:"Sign Out"})]})]})]}):(0,o.jsxs)(o.Fragment,{children:[o.jsx(a.Link,{as:"a",href:"/auth/signin",color:"white",_hover:{color:"secondary.200"},children:"Sign In"}),o.jsx(a.Button,{as:"a",href:"/auth/signup",colorScheme:"secondary",size:"sm",_hover:{bg:"secondary.600"},children:"Sign Up"})]})})]})})}),o.jsx(a.Box,{bg:"primary.700",py:2,children:o.jsx(a.Container,{maxW:"container.xl",children:(0,o.jsxs)(a.Flex,{gap:6,children:[o.jsx(c(),{href:"/events",legacyBehavior:!0,children:(0,o.jsxs)(a.Link,{color:"white",_hover:{color:"secondary.200"},display:"flex",alignItems:"center",gap:2,children:[o.jsx(i.CalendarIcon,{}),"All Events"]})}),o.jsx(c(),{href:"/events/today",legacyBehavior:!0,children:(0,o.jsxs)(a.Link,{color:"white",_hover:{color:"secondary.200"},display:"flex",alignItems:"center",gap:2,children:[o.jsx(i.TimeIcon,{}),"Today's Events"]})}),o.jsx(c(),{href:"/events/popular",legacyBehavior:!0,children:(0,o.jsxs)(a.Link,{color:"white",_hover:{color:"secondary.200"},display:"flex",alignItems:"center",gap:2,children:[o.jsx(i.StarIcon,{}),"Popular"]})}),o.jsx(c(),{href:"/favorites",legacyBehavior:!0,children:(0,o.jsxs)(a.Link,{color:"white",_hover:{color:"secondary.200"},display:"flex",alignItems:"center",gap:2,children:[o.jsx(i.StarIcon,{}),"Favorites"]})}),o.jsx(c(),{href:"/events/nearby",legacyBehavior:!0,children:(0,o.jsxs)(a.Link,{color:"white",_hover:{color:"secondary.200"},display:"flex",alignItems:"center",gap:2,children:[o.jsx(i.TimeIcon,{}),"Near Me"]})})]})})}),o.jsx(a.Box,{as:"main",children:e})]})}[a,i]=u.then?(await u)():u,s()}catch(e){s(e)}})},8726:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var s=r(1649),o=r(6689);function a(){let{data:e,status:t}=(0,s.useSession)(),[r,a]=(0,o.useState)(!1);return{isAdmin:r,isLoading:"loading"===t,isAuthenticated:"authenticated"===t}}},6814:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{default:()=>d});var o=r(997),a=r(2210),i=r(1649),n=r(862),c=r(8981);r(6764);var l=e([a,n,c]);function d({Component:e,pageProps:{session:t,...r}}){return o.jsx(i.SessionProvider,{session:t,children:o.jsx(a.ChakraProvider,{theme:c.Z,children:o.jsx(n.Z,{children:o.jsx(e,{...r})})})})}[a,n,c]=l.then?(await l)():l,s()}catch(e){s(e)}})},3432:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{default:()=>h,getServerSideProps:()=>u});var o=r(997),a=r(2210),i=r(1649),n=r(1163),c=r(8726),l=r(6689),d=e([a]);function h({initialLocations:e}){let[t,r]=(0,l.useState)(e),[s,d]=(0,l.useState)(!1),[h,u]=(0,l.useState)({address:""}),[x,p]=(0,l.useState)(!1),{isOpen:g,onOpen:m,onClose:f}=(0,a.useDisclosure)(),j=(0,a.useToast)(),y=(0,n.useRouter)(),{data:b,status:v}=(0,i.useSession)({required:!0,onUnauthenticated(){y.push("/auth/signin")}}),{isAdmin:S,isLoading:w}=(0,c.A)();console.log("Locations admin page - Session:",b),console.log("Locations admin page - isAdmin:",S),console.log("Initial locations data:",e);let C=async()=>{try{console.log("Fetching locations from API");let e=await fetch("/api/locations");if(!e.ok)throw Error("Failed to fetch locations");let t=await e.json(),s=Array.isArray(t)?t:t.locations||[];console.log("Refreshed locations data:",s),r(s)}catch(e){console.error("Error fetching locations:",e),j({title:"Error",description:"Failed to load locations",status:"error",duration:3e3,isClosable:!0})}},P=e=>{e?(u(e),p(!0)):(u({}),p(!1)),m()},I=async()=>{try{let e;if(d(!0),!h.address){j({title:"Error",description:"Address is required",status:"error",duration:3e3,isClosable:!0}),d(!1);return}let t={address:h.address};if(!(e=x&&h.id?await fetch(`/api/locations/${h.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}):await fetch("/api/locations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok){let t=await e.json();throw console.error("API error response:",t),Error(t.message||"Failed to save location")}let r=await e.json();console.log("API success response:",r),await C(),f(),j({title:"Success",description:x?"Location updated successfully":"Location created successfully",status:"success",duration:3e3,isClosable:!0})}catch(e){console.error("Error in handleSubmit:",e),j({title:"Error",description:e.message||"An unexpected error occurred",status:"error",duration:3e3,isClosable:!0})}finally{d(!1)}},L=async e=>{if(confirm("Are you sure you want to delete this location? This action cannot be undone."))try{let t=await fetch(`/api/locations/${e}`,{method:"DELETE"});if(!t.ok){let e=await t.json();throw Error(e.message||"Failed to delete location")}await C(),j({title:"Success",description:"Location deleted successfully",status:"success",duration:3e3,isClosable:!0})}catch(e){j({title:"Error",description:e.message,status:"error",duration:3e3,isClosable:!0})}};return"loading"===v||w?o.jsx(a.Container,{maxW:"container.xl",py:8,children:(0,o.jsxs)(a.Box,{className:"bg-white rounded-lg shadow-md p-8 mb-8",textAlign:"center",children:[o.jsx(a.Heading,{as:"h2",size:"lg",mb:4,children:"Loading..."}),o.jsx(a.Text,{children:"Please wait while we load the locations management page."})]})}):S?(0,o.jsxs)(a.Container,{maxW:"container.xl",py:8,children:[(0,o.jsxs)(a.Box,{className:"bg-white rounded-lg shadow-md p-8 mb-8",children:[(0,o.jsxs)(a.Flex,{justifyContent:"space-between",alignItems:"center",mb:6,children:[o.jsx(a.Heading,{as:"h1",size:"xl",className:"text-primary-700",children:"Locations Management"}),o.jsx(a.Button,{colorScheme:"primary",onClick:()=>P(),children:"Add New Location"})]}),0===t.length?o.jsx(a.Text,{className:"text-gray-600 text-center py-8",children:"No locations found. Create your first location to get started."}):(0,o.jsxs)(a.Table,{variant:"simple",children:[o.jsx(a.Thead,{children:(0,o.jsxs)(a.Tr,{children:[o.jsx(a.Th,{children:"ID"}),o.jsx(a.Th,{children:"Address"}),o.jsx(a.Th,{children:"Actions"})]})}),o.jsx(a.Tbody,{children:t.map(e=>(0,o.jsxs)(a.Tr,{children:[o.jsx(a.Td,{children:e.id}),o.jsx(a.Td,{children:e.address}),o.jsx(a.Td,{children:(0,o.jsxs)(a.Flex,{gap:2,children:[o.jsx(a.Button,{size:"sm",colorScheme:"blue",onClick:()=>P(e),children:"Edit"}),o.jsx(a.Button,{size:"sm",colorScheme:"red",onClick:()=>L(e.id),children:"Delete"})]})})]},e.id))})]})]}),(0,o.jsxs)(a.Modal,{isOpen:g,onClose:f,children:[o.jsx(a.ModalOverlay,{}),(0,o.jsxs)(a.ModalContent,{children:[o.jsx(a.ModalHeader,{children:x?"Edit Location":"Create New Location"}),o.jsx(a.ModalCloseButton,{}),o.jsx(a.ModalBody,{children:(0,o.jsxs)(a.FormControl,{isRequired:!0,mb:4,children:[o.jsx(a.FormLabel,{children:"Address"}),o.jsx(a.Input,{value:h.address||"",onChange:e=>u({...h,address:e.target.value}),placeholder:"Enter location address"})]})}),(0,o.jsxs)(a.ModalFooter,{children:[o.jsx(a.Button,{variant:"outline",mr:3,onClick:f,children:"Cancel"}),o.jsx(a.Button,{colorScheme:"primary",onClick:I,isLoading:s,children:x?"Update":"Create"})]})]})]})]}):o.jsx(a.Container,{maxW:"container.xl",py:8,children:(0,o.jsxs)(a.Box,{className:"bg-white rounded-lg shadow-md p-8 mb-8",textAlign:"center",children:[o.jsx(a.Heading,{as:"h2",size:"lg",mb:4,children:"Access Denied"}),o.jsx(a.Text,{mb:4,children:"You do not have admin privileges to access this page."}),o.jsx(a.Button,{colorScheme:"blue",onClick:()=>y.push("/"),children:"Go to Homepage"})]})})}a=(d.then?(await d)():d)[0];let u=async e=>{if(!await (0,i.getSession)(e))return{redirect:{destination:"/auth/signin",permanent:!1}};try{let e=process.env.NEXTAUTH_URL||"http://localhost:3001";console.log("Fetching locations from:",`${e}/api/locations`);let t=await fetch(`${e}/api/locations`),r=await t.json(),s=Array.isArray(r)?r:r.locations||[];return console.log("Locations data structure:",s),{props:{initialLocations:s}}}catch(e){return console.error("Error fetching locations:",e),{props:{initialLocations:[]}}}};s()}catch(e){s(e)}})},8981:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{Z:()=>i});var o=r(2210),a=e([o]);o=(a.then?(await a)():a)[0];let i=(0,o.extendTheme)({styles:{global:{body:{bg:"#f8fafc"}}},components:{Button:{defaultProps:{colorScheme:"primary"}}},colors:{primary:{50:"#f0f9ff",100:"#e0f2fe",200:"#bae6fd",300:"#7dd3fc",400:"#38bdf8",500:"#0ea5e9",600:"#0284c7",700:"#0369a1",800:"#075985",900:"#0c4a6e"},secondary:{50:"#f0fdfa",100:"#ccfbf1",200:"#99f6e4",300:"#5eead4",400:"#2dd4bf",500:"#14b8a6",600:"#0d9488",700:"#0f766e",800:"#115e59",900:"#134e4a"},accent:{50:"#fdf4ff",100:"#fae8ff",200:"#f5d0fe",300:"#f0abfc",400:"#e879f9",500:"#d946ef",600:"#c026d3",700:"#a21caf",800:"#86198f",900:"#701a75"}},config:{initialColorMode:"light",useSystemColorMode:!1}});s()}catch(e){s(e)}})},6764:()=>{},1649:e=>{"use strict";e.exports=require("next-auth/react")},2785:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{"use strict";e.exports=require("react")},6405:e=>{"use strict";e.exports=require("react-dom")},997:e=>{"use strict";e.exports=require("react/jsx-runtime")},2048:e=>{"use strict";e.exports=require("fs")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},1568:e=>{"use strict";e.exports=require("zlib")},6134:e=>{"use strict";e.exports=import("@chakra-ui/icons")},2210:e=>{"use strict";e.exports=import("@chakra-ui/react")}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[117,899,664,342],()=>r(6638));module.exports=s})();