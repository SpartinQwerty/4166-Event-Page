(()=>{var e={};e.id=32,e.ids=[32,888,660],e.modules={2897:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{config:()=>f,default:()=>u,getServerSideProps:()=>g,getStaticPaths:()=>m,getStaticProps:()=>x,reportWebVitals:()=>p,routeModule:()=>w,unstable_getServerProps:()=>b,unstable_getServerSideProps:()=>S,unstable_getStaticParams:()=>y,unstable_getStaticPaths:()=>j,unstable_getStaticProps:()=>v});var a=r(7093),i=r(5244),n=r(1323),o=r(2899),l=r.n(o),c=r(6814),d=r(1051),h=e([c,d]);[c,d]=h.then?(await h)():h;let u=(0,n.l)(d,"default"),x=(0,n.l)(d,"getStaticProps"),m=(0,n.l)(d,"getStaticPaths"),g=(0,n.l)(d,"getServerSideProps"),f=(0,n.l)(d,"config"),p=(0,n.l)(d,"reportWebVitals"),v=(0,n.l)(d,"unstable_getStaticProps"),j=(0,n.l)(d,"unstable_getStaticPaths"),y=(0,n.l)(d,"unstable_getStaticParams"),b=(0,n.l)(d,"unstable_getServerProps"),S=(0,n.l)(d,"unstable_getServerSideProps"),w=new a.PagesRouteModule({definition:{kind:i.x.PAGES,page:"/events/[id]",pathname:"/events/[id]",bundlePath:"",filename:""},components:{App:c.default,Document:l()},userland:d});s()}catch(e){s(e)}})},862:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{Z:()=>x});var a=r(997),i=r(2210),n=r(6134),o=r(1664),l=r.n(o),c=r(1649),d=r(6689),h=r(8726),u=e([i,n]);function x({children:e}){let{data:t}=(0,c.useSession)(),{isAdmin:r}=(0,h.A)(),[s,o]=(0,d.useState)("");console.log("Session data:",t),console.log("Is admin:",r);let u=e=>{e.preventDefault(),console.log("Searching for:",s)};return(0,a.jsxs)(i.Box,{children:[a.jsx(i.Box,{as:"nav",bg:"primary.600",py:2,position:"sticky",top:0,zIndex:1e3,children:a.jsx(i.Container,{maxW:"container.xl",children:(0,a.jsxs)(i.Flex,{align:"center",gap:4,children:[a.jsx(i.Link,{as:"a",href:"/",fontSize:"xl",fontWeight:"bold",color:"white",_hover:{textDecoration:"none",color:"primary.100"},children:"EventHub"}),a.jsx(i.Flex,{flex:1,mx:4,children:a.jsx("form",{onSubmit:u,style:{width:"100%"},children:(0,a.jsxs)(i.InputGroup,{size:"md",children:[a.jsx(i.Input,{bg:"white",placeholder:"Search events...",value:s,onChange:e=>o(e.target.value),borderRadius:"md",height:"40px",_focus:{borderColor:"secondary.300",boxShadow:"0 0 0 1px var(--chakra-colors-secondary-300)"}}),a.jsx(i.InputRightElement,{h:"100%",children:a.jsx(i.Button,{height:"100%",w:"100%",onClick:u,bg:"secondary.500",color:"white",_hover:{bg:"secondary.600"},borderLeftRadius:"0",borderRightRadius:"md",children:a.jsx(n.SearchIcon,{})})})]})})}),a.jsx(i.Flex,{gap:4,align:"center",children:t?(0,a.jsxs)(a.Fragment,{children:[a.jsx(i.Link,{as:"a",href:"/events/create",color:"white",_hover:{color:"secondary.200"},children:"Create Event"}),r&&a.jsx(i.Button,{as:"a",href:"/admin",colorScheme:"red",size:"sm",leftIcon:a.jsx(i.Icon,{as:n.StarIcon}),_hover:{bg:"red.600"},children:"Admin"}),(0,a.jsxs)(i.Menu,{children:[a.jsx(i.MenuButton,{as:i.Button,variant:"ghost",color:"white",_hover:{bg:"primary.700"},_active:{bg:"primary.700"},children:"Account"}),(0,a.jsxs)(i.MenuList,{children:[a.jsx(i.MenuItem,{as:"a",href:"/profile",children:"Profile"}),a.jsx(i.MenuItem,{as:"a",href:"/favorites",children:"My Favorites"}),a.jsx(i.MenuItem,{onClick:()=>{(0,c.signOut)({callbackUrl:"/",redirect:!0})},children:"Sign Out"})]})]})]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx(i.Link,{as:"a",href:"/auth/signin",color:"white",_hover:{color:"secondary.200"},children:"Sign In"}),a.jsx(i.Button,{as:"a",href:"/auth/signup",colorScheme:"secondary",size:"sm",_hover:{bg:"secondary.600"},children:"Sign Up"})]})})]})})}),a.jsx(i.Box,{bg:"primary.700",py:2,children:a.jsx(i.Container,{maxW:"container.xl",children:(0,a.jsxs)(i.Flex,{gap:6,children:[a.jsx(l(),{href:"/events",legacyBehavior:!0,children:(0,a.jsxs)(i.Link,{color:"white",_hover:{color:"secondary.200"},display:"flex",alignItems:"center",gap:2,children:[a.jsx(n.CalendarIcon,{}),"All Events"]})}),a.jsx(l(),{href:"/events/today",legacyBehavior:!0,children:(0,a.jsxs)(i.Link,{color:"white",_hover:{color:"secondary.200"},display:"flex",alignItems:"center",gap:2,children:[a.jsx(n.TimeIcon,{}),"Today's Events"]})}),a.jsx(l(),{href:"/events/popular",legacyBehavior:!0,children:(0,a.jsxs)(i.Link,{color:"white",_hover:{color:"secondary.200"},display:"flex",alignItems:"center",gap:2,children:[a.jsx(n.StarIcon,{}),"Popular"]})}),a.jsx(l(),{href:"/favorites",legacyBehavior:!0,children:(0,a.jsxs)(i.Link,{color:"white",_hover:{color:"secondary.200"},display:"flex",alignItems:"center",gap:2,children:[a.jsx(n.StarIcon,{}),"Favorites"]})}),a.jsx(l(),{href:"/events/nearby",legacyBehavior:!0,children:(0,a.jsxs)(i.Link,{color:"white",_hover:{color:"secondary.200"},display:"flex",alignItems:"center",gap:2,children:[a.jsx(n.TimeIcon,{}),"Near Me"]})})]})})}),a.jsx(i.Box,{as:"main",children:e})]})}[i,n]=u.then?(await u)():u,s()}catch(e){s(e)}})},8726:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var s=r(1649),a=r(6689);function i(){let{data:e,status:t}=(0,s.useSession)(),[r,i]=(0,a.useState)(!1);return{isAdmin:r,isLoading:"loading"===t,isAuthenticated:"authenticated"===t}}},6814:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{default:()=>d});var a=r(997),i=r(2210),n=r(1649),o=r(862),l=r(8981);r(6764);var c=e([i,o,l]);function d({Component:e,pageProps:{session:t,...r}}){return a.jsx(n.SessionProvider,{session:t,children:a.jsx(i.ChakraProvider,{theme:l.Z,children:a.jsx(o.Z,{children:a.jsx(e,{...r})})})})}[i,o,l]=c.then?(await c)():c,s()}catch(e){s(e)}})},1051:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{default:()=>u,getServerSideProps:()=>x});var a=r(997),i=r(6689),n=r.n(i),o=r(1163),l=r(1649),c=r(2210),d=r(6134),h=e([c,d]);function u({event:e}){var t,r;let s=(0,o.useRouter)(),{data:h}=(0,l.useSession)(),u=(0,c.useToast)(),[x,m]=(0,i.useState)(!1),[g,f]=(0,i.useState)(!1),[p,v]=(0,i.useState)([]),[j,y]=(0,i.useState)(!1),[b,S]=(0,i.useState)(!1),[w,I]=(0,i.useState)(!1),[C,E]=(0,i.useState)(!1),[B,k]=(0,i.useState)(!1),[F,T]=(0,i.useState)(!1),N=n().useRef(null),P=h?.user?.email===e.author.username,L=async()=>{if(!h){u({title:"Authentication required",description:"You must be signed in to favorite an event",status:"error",duration:3e3,isClosable:!0});return}T(!0);try{if(B){if(!(await fetch(`/api/favorites?eventId=${e.id}`,{method:"DELETE"})).ok)throw Error("Failed to remove from favorites");u({title:"Removed from favorites",description:"Event removed from your favorites",status:"success",duration:3e3,isClosable:!0}),k(!1)}else{if(!(await fetch("/api/favorites",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({eventId:e.id})})).ok)throw Error("Failed to add to favorites");u({title:"Added to favorites",description:"Event added to your favorites",status:"success",duration:3e3,isClosable:!0}),k(!0)}}catch(e){u({title:"Error",description:e.message||"Failed to update favorites",status:"error",duration:3e3,isClosable:!0})}finally{T(!1)}},A=async()=>{y(!0);try{let t=await fetch(`/api/participants?eventId=${e.id}`);if(!t.ok)throw Error("Failed to fetch participants");let r=await t.json();v(r)}catch(e){console.error("Error fetching participants:",e),u({title:"Error",description:"Failed to load participants",status:"error",duration:3e3,isClosable:!0})}finally{y(!1)}},_=async()=>{if(!h){u({title:"Authentication required",description:"You must be signed in to join an event",status:"error",duration:3e3,isClosable:!0});return}S(!0);try{let t=await fetch("/api/participants",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({eventId:e.id})});if(!t.ok){let e=await t.json();throw Error(e.message||"Failed to join event")}u({title:"Success",description:"You have joined this event",status:"success",duration:3e3,isClosable:!0}),A(),E(!0)}catch(e){u({title:"Error",description:e.message||"Failed to join event",status:"error",duration:3e3,isClosable:!0})}finally{S(!1)}},D=async()=>{if(!h){u({title:"Authentication required",description:"You must be signed in to leave an event",status:"error",duration:3e3,isClosable:!0});return}I(!0);try{let t=await fetch(`/api/participants?eventId=${e.id}`,{method:"DELETE"});if(!t.ok){let e=await t.json();throw Error(e.message||"Failed to leave event")}u({title:"Success",description:"You have left this event",status:"success",duration:3e3,isClosable:!0}),A(),E(!1)}catch(e){u({title:"Error",description:e.message||"Failed to leave event",status:"error",duration:3e3,isClosable:!0})}finally{I(!1)}},z=()=>{f(!1)},q=async()=>{if(!h){u({title:"Authentication required",description:"You must be signed in to delete an event",status:"error",duration:3e3,isClosable:!0});return}m(!0);try{let t=await fetch(`/api/events?id=${e.id}`,{method:"DELETE"});if(!t.ok){let e=await t.json();throw Error(e.message)}u({title:"Event deleted",description:"The event has been successfully deleted",status:"success",duration:3e3,isClosable:!0}),s.push("/")}catch(e){u({title:"Error",description:e.message||"Failed to delete event",status:"error",duration:3e3,isClosable:!0})}finally{m(!1),z()}};return s.isFallback?a.jsx(c.Container,{maxW:"container.md",py:8,children:a.jsx(c.Text,{children:"Loading event details..."})}):(0,a.jsxs)(c.Container,{maxW:"container.lg",py:8,children:[(0,a.jsxs)(c.Box,{className:"bg-white rounded-lg shadow-md p-8 my-8",children:[(0,a.jsxs)(c.Flex,{justifyContent:"space-between",alignItems:"flex-start",mb:6,flexWrap:"wrap",children:[(0,a.jsxs)(c.Box,{children:[a.jsx(c.Heading,{as:"h1",size:"xl",className:"text-primary-700",children:e.title}),(0,a.jsxs)(c.Flex,{mt:2,alignItems:"center",children:[a.jsx(c.Badge,{colorScheme:"purple",mr:2,p:1,borderRadius:"md",children:e.game.title}),(0,a.jsxs)(c.Text,{fontSize:"sm",color:"gray.500",children:["Hosted by ",e.author.firstName," ",e.author.lastName]})]})]}),(0,a.jsxs)(c.Flex,{mt:{base:4,md:0},gap:2,children:[h&&a.jsx(c.Tooltip,{label:B?"Remove from favorites":"Add to favorites",children:a.jsx(c.Button,{colorScheme:B?"yellow":"gray",variant:B?"solid":"outline",onClick:L,isLoading:F,leftIcon:a.jsx(d.StarIcon,{}),mr:2,children:B?"Favorited":"Favorite"})}),P&&a.jsx(c.Button,{colorScheme:"red",variant:"outline",onClick:()=>{f(!0)},isLoading:x,leftIcon:a.jsx(d.InfoIcon,{}),className:"hover:bg-red-50",children:"Delete Event"}),!P&&h&&(C?a.jsx(c.Button,{colorScheme:"red",variant:"outline",onClick:D,isLoading:w,leftIcon:a.jsx(d.CloseIcon,{}),className:"hover:bg-red-50",children:"Leave Event"}):a.jsx(c.Button,{colorScheme:"green",variant:"solid",onClick:_,isLoading:b,leftIcon:a.jsx(d.AddIcon,{}),className:"hover:bg-green-600",children:"Join Event"})),!h&&(0,a.jsxs)(a.Fragment,{children:[a.jsx(c.Button,{as:"a",href:"/auth/signin",colorScheme:"yellow",variant:"outline",leftIcon:a.jsx(d.StarIcon,{}),mr:2,children:"Sign in to favorite"}),a.jsx(c.Button,{as:"a",href:"/auth/signin",colorScheme:"blue",variant:"outline",children:"Sign in to join"})]})]})]}),a.jsx(c.Divider,{mb:6}),(0,a.jsxs)(c.Box,{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,a.jsxs)(c.Box,{children:[(0,a.jsxs)(c.Box,{mb:6,children:[a.jsx(c.Heading,{as:"h3",size:"md",mb:3,className:"text-primary-700",children:"About This Event"}),a.jsx(c.Text,{className:"text-gray-700 whitespace-pre-line",children:e.description})]}),(0,a.jsxs)(c.Box,{mb:6,children:[a.jsx(c.Heading,{as:"h3",size:"md",mb:3,className:"text-primary-700",children:"Date & Time"}),(0,a.jsxs)(c.Flex,{alignItems:"center",mb:2,children:[a.jsx(d.CalendarIcon,{mr:2,color:"secondary.500"}),a.jsx(c.Text,{children:(t=e.date,("string"==typeof t?new Date(t):t).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}))})]}),(0,a.jsxs)(c.Flex,{alignItems:"center",children:[a.jsx(d.TimeIcon,{mr:2,color:"secondary.500"}),a.jsx(c.Text,{children:(r=e.date,("string"==typeof r?new Date(r):r).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}))})]})]}),(0,a.jsxs)(c.Box,{mb:6,children:[a.jsx(c.Heading,{as:"h3",size:"md",mb:3,className:"text-primary-700",children:"Game Details"}),a.jsx(c.Text,{fontWeight:"bold",className:"text-secondary-600",children:e.game.title}),a.jsx(c.Text,{className:"text-gray-700 mt-1",children:e.game.description})]}),(0,a.jsxs)(c.Box,{mb:6,children:[(0,a.jsxs)(c.Heading,{as:"h3",size:"md",mb:3,className:"text-primary-700",children:["Participants (",p.length,")"]}),j?a.jsx(c.Flex,{justify:"center",my:4,children:a.jsx(c.Spinner,{size:"md",color:"secondary.500"})}):p.length>0?a.jsx(c.List,{spacing:2,children:p.map(t=>(0,a.jsxs)(c.ListItem,{className:"flex items-center py-1",children:[a.jsx(c.Avatar,{size:"sm",name:`${t.firstName} ${t.lastName}`,mr:2,bg:"secondary.500"}),(0,a.jsxs)(c.Text,{children:[t.firstName," ",t.lastName,t.username===e.author.username&&a.jsx(c.Badge,{ml:2,colorScheme:"purple",children:"Host"}),t.username===h?.user?.email&&a.jsx(c.Badge,{ml:2,colorScheme:"green",children:"You"})]})]},t.participantId))}):a.jsx(c.Text,{className:"text-gray-500 italic",children:"No participants yet. Be the first to join!"})]})]}),(0,a.jsxs)(c.Box,{children:[a.jsx(c.Heading,{as:"h3",size:"md",mb:3,className:"text-primary-700",children:"Location"}),(0,a.jsxs)(c.Box,{className:"rounded-lg overflow-hidden border border-gray-200 p-4 bg-gray-50",children:[(0,a.jsxs)(c.Text,{className:"text-gray-700 font-medium mb-2",children:[a.jsx(d.InfoIcon,{mr:2,color:"secondary.500"}),"Event Location"]}),a.jsx(c.Text,{className:"text-gray-600",children:e.location.address})]})]})]})]}),a.jsx(c.AlertDialog,{isOpen:g,leastDestructiveRef:N,onClose:z,children:a.jsx(c.AlertDialogOverlay,{children:(0,a.jsxs)(c.AlertDialogContent,{children:[a.jsx(c.AlertDialogHeader,{fontSize:"lg",fontWeight:"bold",children:"Delete Event"}),a.jsx(c.AlertDialogBody,{children:"Are you sure you want to delete this event? This action cannot be undone."}),(0,a.jsxs)(c.AlertDialogFooter,{children:[a.jsx(c.Button,{ref:N,onClick:z,children:"Cancel"}),a.jsx(c.Button,{colorScheme:"red",onClick:q,ml:3,isLoading:x,children:"Delete"})]})]})})})]})}[c,d]=h.then?(await h)():h;let x=async e=>{let{id:t}=e.params||{};if(!t||"string"!=typeof t)return{notFound:!0};try{let r=process.env.NEXTAUTH_URL||`http://${e.req.headers.host}`,s=await fetch(`${r}/api/events?id=${t}`);if(!s.ok)throw console.error("Failed to fetch event:",await s.text()),Error("Failed to fetch event");let a=await s.json();return console.log("Successfully fetched event:",t),{props:{event:{...a,date:new Date(a.date).toISOString()}}}}catch(e){return console.error("Error fetching event:",e),{notFound:!0}}};s()}catch(e){s(e)}})},8981:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{Z:()=>n});var a=r(2210),i=e([a]);a=(i.then?(await i)():i)[0];let n=(0,a.extendTheme)({styles:{global:{body:{bg:"#f8fafc"}}},components:{Button:{defaultProps:{colorScheme:"primary"}}},colors:{primary:{50:"#f0f9ff",100:"#e0f2fe",200:"#bae6fd",300:"#7dd3fc",400:"#38bdf8",500:"#0ea5e9",600:"#0284c7",700:"#0369a1",800:"#075985",900:"#0c4a6e"},secondary:{50:"#f0fdfa",100:"#ccfbf1",200:"#99f6e4",300:"#5eead4",400:"#2dd4bf",500:"#14b8a6",600:"#0d9488",700:"#0f766e",800:"#115e59",900:"#134e4a"},accent:{50:"#fdf4ff",100:"#fae8ff",200:"#f5d0fe",300:"#f0abfc",400:"#e879f9",500:"#d946ef",600:"#c026d3",700:"#a21caf",800:"#86198f",900:"#701a75"}},config:{initialColorMode:"light",useSystemColorMode:!1}});s()}catch(e){s(e)}})},6764:()=>{},1649:e=>{"use strict";e.exports=require("next-auth/react")},2785:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{"use strict";e.exports=require("react")},6405:e=>{"use strict";e.exports=require("react-dom")},997:e=>{"use strict";e.exports=require("react/jsx-runtime")},2048:e=>{"use strict";e.exports=require("fs")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},1568:e=>{"use strict";e.exports=require("zlib")},6134:e=>{"use strict";e.exports=import("@chakra-ui/icons")},2210:e=>{"use strict";e.exports=import("@chakra-ui/react")}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[117,899,664,342],()=>r(2897));module.exports=s})();